<html>
  <head>
    <style>
      body {
          background-color:#222;
          color:white;
          display: flex;
          align-items: center;
          justify-content: center;
          font-family: Arial;
      }
      a:link {
	  color: #88f; text-decoration: underline;
      }
      a:visited {
	  color: #88f;  text-decoration: underline;
      }
      a:hover {
	  color: #88f; text-decoration: underline;
      }
      a:active {
	  color: #88f; text-decoration: underline;
      }
    </style>
    <script>
      var progs={
          "apl":"out←{\n⎕←⍵\n}\nout ⍞\nout ⍞\nout ⍞\n",
          "assembly":"// https://en.wikibooks.org/wiki/X86_Assembly/GNU_assembly_syntax\n// https://web.stanford.edu/class/cs107/resources/x86-64-reference.pdf\n// this is the \"main\" function \n        .globl	main\nmain:\n        // \"subq Src, Dest\" does \"Dest = Dest − Src\"\n        // %rsp is the Stack pointer, we allocate 1008 bytes on the stack:\n        // a buffer of size 1000 and and 8 byte int:\n	subq	\$1008, %rsp\n	movq	%fs:40, %rax\n	movq	%rax, 1000(%rsp)\n        // %rsi stores buffer to write to\n	movq	%rsp, %rsi\n.LOOP:\n	movl	\$1000, %edx\n        // set %edi to 0 (stdin)\n        movl    \$0, %edi\n        // perform read system call with arguments %edi %rsi %edx\n	call	read@PLT\n        // tests if %eax (return code) is zero or not.\n	testl	%eax, %eax\n        // if it is zero, no more data, go to .ENDLOOP\n	jle	.ENDLOOP\n        // move %eax (value returned by read) to %rdx 3rd argument of write\n	movslq	%eax, %rdx\n        // move value 1 (stdout) to register %edi\n	movl	\$1, %edi\n        // perform write system call with arguments %edi %rsp %rdx\n	call	write@PLT\n        // back to the beginnig of the loop\n	jmp	.LOOP\n.ENDLOOP:\n	movq	1000(%rsp), %rax\n	subq	%fs:40, %rax\n        // we release the 1008 bytes previously allocated\n	addq	\$1008, %rsp\n	ret\n",
          "bash":"dd\n",
          "bqn":"•Out¨ •args\n",
          "c":"#include <unistd.h>\n\nint main(void) {\n    char buf[1000];\n    int c;\n    while ((c=read(0,buf,1000))>0) {\n        write(1,buf,c);\n    }   \n    return c;\n}\n",
          "clojure":"(ns clojure.examples.hello\n   (:gen-class))\n(defn hello-world []\n   (doseq [ln (line-seq (java.io.BufferedReader. *in*))]\n   (println ln)))\n(hello-world)\n",
          "cobol":"HELLO\n       IDENTIFICATION DIVISION.\n       PROGRAM-ID. ADDITION.\n       DATA DIVISION.\n       WORKING-STORAGE SECTION.\n       77 NUM_1 PIC Z(10).\n       01 WS-STR PIC X(20) VALUE ' '. \n       01 WS-SPACE PIC X(20).                       \n       01 WS-FIELD PIC X(20).                       \n\n       PROCEDURE DIVISION.\n       PARA.\n       ACCEPT NUM_1.\n       MOVE NUM_1 TO WS-STR.\n       UNSTRING WS-STR DELIMITED BY ALL SPACES INTO   \n                WS-SPACE,WS-FIELD.   \n       DISPLAY WS-FIELD.\n       ACCEPT NUM_1.\n       MOVE NUM_1 TO WS-STR.\n       UNSTRING WS-STR DELIMITED BY ALL SPACES INTO   \n                WS-SPACE,WS-FIELD.   \n       DISPLAY WS-FIELD.\n       ACCEPT NUM_1.\n       MOVE NUM_1 TO WS-STR.\n       UNSTRING WS-STR DELIMITED BY ALL SPACES INTO   \n                WS-SPACE,WS-FIELD.   \n       DISPLAY WS-FIELD.\n       STOP RUN.\n",
          "cpp":"#include <iostream>\nusing namespace std;\n\nint main () {\n  int a;\n  cout << (cin >> a,a) << endl;\n  cout << (cin >> a,a) << endl;\n  cout << (cin >> a,a) << endl;\n  return 0;\n}\n",
          "csharp":"using static System.Console;\nclass H {\n    static void Main() {\n       WriteLine (ReadLine());\n       WriteLine (ReadLine());\n       WriteLine (ReadLine());\n    }\n}",
          "dc":"?fc?fc?fc\n",
          "elixir":"IO.write(IO.read(:stdio, :line))\nIO.write(IO.read(:stdio, :line))\nIO.write(IO.read(:stdio, :line))\n",
          "erlang":"-module(prog).\n-export([start/0]).\nstart() ->\n    hello(3).\n\n%% Do nothing when there is no hello to write\nhello(N) when N =< 0 -> ok;\n%% Else, write a 'Hello World!', and then write (n-1) hellos\nhello(N) ->\n   Line = io:get_line(\"\"),\n   io:format(Line),\n   hello(N - 1).\n",
          "fig":"",
          "fortran":"Program Hello\ncharacter(len=23) :: str\ndo n = 1, 3\n    read *, i\n    write(str,'(1i10)') i\n    write(*,'(a)') trim(adjustl(trim(str)))\nend do\nEnd Program Hello\n ",
          "fsharp":"open System\n[<EntryPoint>]\nlet main args =\n    printfn \"%s\" (Console.ReadLine())\n    printfn \"%s\" (Console.ReadLine())\n    printfn \"%s\" (Console.ReadLine())\n    0 // return an integer exit code\n",
          "go":"package main\n\nimport \"fmt\"\nimport \"os\"\nimport \"bufio\"\nimport \"log\"\n\nfunc main() {\n  scanner := bufio.NewScanner(os.Stdin)\n  for scanner.Scan() {\n        fmt.Println(scanner.Text())\n  }\n\n  if err := scanner.Err(); err != nil {\n        log.Println(err)\n  }\n}\n",
          "golfscript":"\n",
          "haskell":"import System.IO\n\nmain = do\n    z <- getLine\n    putStrLn z\n    z <- getLine\n    putStrLn z\n    z <- getLine\n    putStrLn z\n",
	  "j":"a=: 1!:1 <3\necho a\n",
          "java":"import java.io.*;\npublic class prog {\n   public static void main (String[] args) {\n      BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n      try {\n        System.out.println(br.readLine());\n        System.out.println(br.readLine());\n        System.out.println(br.readLine());\n      }  catch (IOException ioe) {\n         System.out.println(ioe);\n      }\n   }\n}\n",
          "jelly":"0ƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈƈ\n",
          "julia":"print(readline())\nprint(\"\n\")\nprint(readline())\nprint(\"\n\")\nprint(readline())\nprint(\"\n\")\n",
          "k":"`0:0:0\n",
          "kotlin":"fun main() {\n println(generateSequence(::readLine).joinToString(\"\\n\"))\n}\n",
          "lisp":"(write-line (read-line))\n(write-line (read-line))\n(write-line (read-line))\n",
          "logo":"print readrawline\nprint readrawline\nprint readrawline\nbye\n",
          "lua":"print(io.read(\"*a\"))\n",
          "node":"console.log(prompt());\nconsole.log(prompt());\nconsole.log(prompt());\n",
          "ocaml":"let i = read_int () in\nlet j = read_int () in\nlet k = read_int () in\nprint_int i;\nprint_string \"\n\";\nprint_int j;\nprint_string \"\n\";\nprint_int k;\nprint_string \"\n\";\n",
          "perl":"while (<>) {\nprint;\n}\n",
          "php":"<?php\n$a=\"\";\nwhile (fscanf(STDIN, \"%s\",$a)) {\n  echo \"$a\n\";\n}\n?>\n",
          "postscript":"% read thinking in postscript\n%https://w3-o.cs.hm.edu/users/ruckert/public_html/compiler/ThinkingInPostScript.pdf\n(%stdout)  (w) file dup          % write to stdout\n/myinput (%stdin)  (r) file def  % define myinput as stdin \nmyinput (toto) readline pop      % read one line from std in\nwritestring                      % write it to stdout\ndup (\\n) writestring             % write \\n to stdout\ndup                              % duplicate stdout on stack\nmyinput (toto) readline pop      % read one line from std in\nwritestring                      % write it to stdout\ndup (\\n) writestring             % write \\n to stdout\ndup                              \nmyinput (toto) readline pop\nwritestring\ndup (\\n) writestring\nclosefile                        %  close stdout\n",
	  "powershell":"cat",
	  "prolog":"main:- \n    % read and output a string\n    read_line_to_string(user_input,A),writeln(A),\n    read_line_to_string(user_input,B),writeln(B),\n    read_line_to_string(user_input,C),writeln(C).\n",
          "python":"print(open(0).read())\n",
          "r":"x <- scan(file(\"stdin\"),quiet = TRUE);\ncat(x[1]);\ncat(\"\n\")\ncat(x[2]);\ncat(\"\n\")\ncat(x[3]);\ncat(\"\n\")\n",
	  "raku":"for lines() {\n    say \"\", \$_\n}",
          "ruby":"puts *$<\n",
          "rust":"use std::io::{self, BufRead};\n\nfn main() {\n    let stdin = io::stdin();\n    for line in stdin.lock().lines() {\n        println!(\"{}\", line.unwrap());\n    }\n}\n",
          "scala":"import scala.io.StdIn.readLine\nobject p {\n  def main(args: Array[String]): Unit = {\n    println(readLine())\n    println(readLine())\n    println(readLine())\n  }\n}\n",
          "swift":"print(readLine(strippingNewline: true)!)\nprint(readLine(strippingNewline: true)!)\nprint(readLine(strippingNewline: true)!)\n",
	  "vyxal":"\n",
	  "zsh":"cat"
      };
      function getQueryVariable(variable) {
          var query = window.location.search.substring(1);
          var vars = query.split('&');
          for (var i = 0; i < vars.length; i++) {
              var pair = vars[i].split('=');
              if (decodeURIComponent(pair[0]) == variable) {
                  return decodeURIComponent(pair[1]);
              }
          }
          console.log('Query variable %s not found', variable);
      }
      function resetLog() {
          document.getElementById('textarea-log').value = "";
      }
      function appendLog(msg) {
          document.getElementById('textarea-log').value += "\n" + msg;
      }
      function sendForm() {
          var countInput=2
          var url ="/?lang="+document.getElementById('lang').value;
          url+="&countInput="+countInput;
          url+="&code="+encodeURIComponent(document.getElementById('code').value);
          url+="&input0="+encodeURIComponent(document.getElementById('input0').value);
          url+="&input1="+encodeURIComponent(document.getElementById('input1').value);
          appendLog("URL: " + url);
          
          let xhr = new XMLHttpRequest();
          xhr.onload = function(progressEvent) {
              appendLog("onload!");
              appendLog(" status = " + xhr.status);
              appendLog(" statusText = " + xhr.statusText);
              
              appendLog(" ------ xhr.responseText ------: ");
              appendLog(xhr.responseText);
              var answer = JSON.parse(xhr.responseText);
              var count=0;
              for (const e of answer.data) {
                  document.getElementById('output'+count).value=decodeURIComponent(e.out);
                  document.getElementById('err'+count).value=decodeURIComponent(e.err);
                  document.getElementById('code'+count).innerHTML=e.code;
                  ++count;
              }
          }
          
          let async = true;
          // Initialize It.
          xhr.open("GET", url, async);
          
          // Send it (Without body data)
          xhr.send();
      }
      function getRandomInt(max) {
          return Math.floor(Math.random() * max);
      }
      function get3ints() {
          var s = getRandomInt(10000).toString()+"\n";
          s+=getRandomInt(10000).toString()+"\n";
          s+=getRandomInt(10000).toString()+"\n";
          return s;
      }
      function changeLang() {
          var lang=document.getElementById('lang').value;
          document.getElementById('code').value=progs[lang];
          document.getElementById('input0').value=get3ints();
          document.getElementById('input1').value=get3ints();
          document.getElementById('output0').value="";
          document.getElementById('output1').value="";
          document.getElementById('err0').value="";
          document.getElementById('err1').value="";
          document.getElementById('code0').innerHTML="";
          document.getElementById('code1').innerHTML="";
	  document.getElementById('dockerfilelink').outerHTML="<a id='dockerfilelink' href='https://github.com/fderepas/try_all_languages/tree/main/docker/"+lang+"' target='_blank'>"+lang+" Dockerfile</a>";
	  document.getElementById('dockerhublink').outerHTML="<a id='dockerhublink' href='https://hub.docker.com/r/fderepas/tal-"+lang+"' target='_blank'>"+lang+" docker image</a>";
          resetLog();
      }
      window.addEventListener('DOMContentLoaded', (event) => {
          // DOM fully loaded and parsed
          changeLang();
      });
    </script>
    <title>testing programs</title>
  </head>
  <body>
    <table>
        <tr>
          <td>language</td>
          <td>
            <select id="lang" onchange="changeLang();">
              <option value="apl">apl</option>
              <option value="assembly">assembly</option>
              <option value="bash">bash</option>
              <option value="bqn">bqn</option>
              <option value="c">c</option>
              <option value="clojure">clojure</option>
              <option value="cobol">cobol</option>
              <option value="cpp">c++</option>
              <option value="csharp">c#</option>
              <option value="dc">dc</option>
              <option value="elixir">elixir</option>
              <option value="erlang">erlang</option>
              <option value="fig">fig</option>
              <option value="fortran">fortran</option>
              <option value="fsharp">f#</option>
              <option value="go">go</option>
              <option value="golfscript">golfscript</option>
              <option value="haskell">haskell</option>
              <option value="j">j</option>
              <option value="java">java</option>
              <option value="jelly">jelly</option>
              <option value="julia">julia</option>
              <option value="k">k</option>
              <option value="kotlin">kotlin</option>
              <option value="lisp">lisp</option>
              <option value="logo">logo</option>
              <option value="lua">lua</option>
              <option value="node">node</option>
              <option value="ocaml">ocaml</option>
              <option value="perl">perl</option>
              <option value="php">php</option>
              <option value="postscript">postscript</option>
              <option value="powershell">powershell</option>
              <option value="prolog">prolog</option>
              <option value="python">python</option>
              <option value="r">r</option>
              <option value="raku">raku</option>
              <option value="ruby">ruby</option>
              <option value="rust">rust</option>
              <option value="scala">scala</option>
              <option value="swift">swift</option>
              <option value="vyxal">vyxal</option>
              <option value="zsh">zsh</option>
            </select>
	    <a id="dockerfilelink" href=""></a>
	    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	    <a id="dockerhublink" href=""></a>
	    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <a href="version.json">all versions</a>
          </td>
        </tr>
        <tr>
          <td>code</td>
          <td>
          <textarea id="code" name="code" rows="8" cols="80"></textarea>
          </td>
        </tr>
        <tr>
          <td>test 1</td>
          <td>
            <table>
              <tr>
                <td>standard input</td><td>standard output</td><td>standard error</td><td>ret. code</td>
              </tr>
              <tr>
                <td>
                  <textarea id="input0" rows="4" cols="20"></textarea>
                </td>
                <td>
                  <textarea id="output0" rows="4" cols="20" style="background-color:black;color:white;" readonly></textarea>
                </td>
                <td>
                  <textarea id="err0" rows="4" cols="20" style="background-color:black;color:white;" readonly></textarea>
                </td>
                <td id="code0"></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td>test 2</td>
          <td>
            <table>
              <tr>
                <td>
                  <textarea id="input1" rows="4" cols="20"></textarea>
                </td>
                <td>
                  <textarea id="output1" rows="4" cols="20" style="background-color:black;color:white;" readonly></textarea>
                </td>
                <td>
                  <textarea id="err1" rows="4" cols="20" style="background-color:black;color:white;" readonly></textarea>
                </td>
                <td id="code1"></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td></td>
          <td>
            <button style="color: white;border: none;padding: 15px 32px;background-color: #04AA6D;" onClick="sendForm();">
	      execute
	    </button>
          </td>
        </tr>
        <tr>
          <td>log</td>
          <td>
            <textarea id="textarea-log" cols="80" rows="5" style="background-color:black;color:white;" readonly></textarea>
          </td>
        </tr>
        <tr>
          <td></td>
          <td>
	    access the source of <a href="https://github.com/fderepas/try_all_languages">try_all_languages</a>
          </td>
        </tr>
    </table>
  </body>
</html>

